% Copyright 2006 by Till Tantau and Mark Wibrow
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.
%
% See the file doc/generic/pgf/licenses/LICENSE for more details.

\ProvidesFileRCS[v\pgfversion] $Header: /cvsroot/pgf/pgf/generic/pgf/libraries/Attic/pgflibraryshapes.shadowed.code.tex,v 1.1 2007/12/17 16:20:50 tantau Exp $


\pgfdeclareradialshading{tikz@lib@round@shadow@border}{\pgfpointorigin}{
  color(0pt)=(pgftransparent!0); color(22bp)=(pgftransparent!0);
  color(25bp)=(pgftransparent!100); color(50bp)=(pgftransparent!100)}
\pgfdeclarefading{tikz@lib@round@shadow@border}{\pgfuseshading{tikz@lib@round@shadow@border}}

\pgfset{
  /pgf/shadow scale/.initial=1.05,
  /pgf/shadow xoffset/.initial=2pt,
  /pgf/shadow yoffset/.initial=-2pt,
  /pgf/shadow color/.initial=black!50
}

\pgfdeclareshape{circle with shadow}
{
  \inheritsavedanchors[from=circle] % this is nearly a circle
  \inheritanchorborder[from=circle]
  \inheritanchor[from=circle]{north}
  \inheritanchor[from=circle]{north west}
  \inheritanchor[from=circle]{north east}
  \inheritanchor[from=circle]{center}
  \inheritanchor[from=circle]{west}
  \inheritanchor[from=circle]{east}
  \inheritanchor[from=circle]{mid}
  \inheritanchor[from=circle]{mid west}
  \inheritanchor[from=circle]{mid east}
  \inheritanchor[from=circle]{base}
  \inheritanchor[from=circle]{base west}
  \inheritanchor[from=circle]{base east}
  \inheritanchor[from=circle]{south}
  \inheritanchor[from=circle]{south west}
  \inheritanchor[from=circle]{south east}
  \inheritbackgroundpath[from=circle]
  \behindbackgroundpath{
    \pgftransformshift{\centerpoint}% 
    \pgftransformscale{\pgfkeysvalueof{/pgf/shadow scale}}%
    \pgftransformshift{\pgfpointscale{-1}{\centerpoint}}% 
    \pgftransformshift{
      \pgfpoint{\pgfkeysvalueof{/pgf/shadow xoffset}}{\pgfkeysvalueof{/pgf/shadow yoffset}}}% Shadow offset.
    \pgfutil@tempdima=\radius%
    \pgfmathsetlength{\pgf@xb}{\pgfkeysvalueof{/pgf/outer xsep}}%  
    \pgfmathsetlength{\pgf@yb}{\pgfkeysvalueof{/pgf/outer ysep}}%  
    \ifdim\pgf@xb<\pgf@yb%
      \advance\pgfutil@tempdima by-\pgf@yb%
    \else%
      \advance\pgfutil@tempdima by-\pgf@xb%
    \fi%
    \pgfpathcircle{\centerpoint}{\pgfutil@tempdima}%
    \pgfsetfadingforcurrentpath{tikz@lib@round@shadow@border}{}% Shadow opacity.
    \pgfsetfillcolor{\pgfkeysvalueof{/pgf/shadow color}}%
    \pgfusepath{fill}%
  }
}

\endinput