% Copyright 2007 by Mark Wibrow
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.
%
% See the file doc/generic/pgf/licenses/LICENSE for more details.

% This file defines the trigonometric functions/operations.
%
% Much of this file is based on ideas and code (particularly 
% \pgfcoremath.code.tex) due to Till Tantau
%
% Version 0.0 08/03/2007

% \pgfmathpi
%
\def\pgfmathpi{\edef\pgfmathresult{\pgfmath@pi}}
\def\pgfmath@pi{3.14159}

% \pgfmathradians
% 
% Convert #1 from radians to degrees (accurate to 1 deg).
%
\def\pgfmathradians#1{%
	\pgfmathevalautae{#1}%
	\pgfmathradians@{\pgfmathresult}}
\def\pgfmathradians@#1{%
	\begingroup%
		\pgfmath@x#1pt\relax%
		\pgfmath@x57.29577\pgfmath@x\relax% 57.29577 = 360/(2*pi)
		\pgfmathround@{\pgf@sys@tonumber{\pgfmath@x}}%
		\pgfmath@x\pgfmathresult pt\relax%
		\pgfmath@returnone\pgfmath@x%
	\endgroup%
}%

% \pgfmathsin
% 
% Calculate the sine of #1 (in degrees).
%
\def\pgfmathsin#1{%
	\pgfmathparse{#1}%
	\pgfmathsin@{\pgfmathresult}}
\def\pgfmathsin@#1{%
	\begingroup%
		\pgfmath@x#1pt\relax%
		\afterassignment\pgfmath@gobbletilpgfmath@%
		\expandafter\c@pgfmath@counta\the\pgfmath@x\relax\pgfmath@%
		\pgfmath@xb\pgfmath@x%
		\advance\pgfmath@xb-\c@pgfmath@counta pt\relax%
		\expandafter\pgfmathsin@@\expandafter{\the\c@pgfmath@counta}%
		\pgfmath@xa\pgfmath@x%
		\ifnum\c@pgfmath@counta>0\relax%
			\advance\c@pgfmath@counta-1\relax%
		\else%
			\advance\c@pgfmath@counta1\relax%
		\fi%
		\expandafter\pgfmathsin@@\expandafter{\the\c@pgfmath@counta}%
		\pgfmath@x\pgfmath@tonumber{\pgfmath@xb}\pgfmath@x%
		\pgfmath@xb-\pgfmath@xb%
		\advance\pgfmath@xb1pt\relax%
		\advance\pgfmath@x\pgfmath@tonumber{\pgfmath@xb}\pgfmath@xa%
		\pgfmath@returnone\pgfmath@x%
	\endgroup%
}
\def\pgfmathsin@@#1{% 
	% NB no \begingroup...\endgroup. I don't think \pgfmathsin@@
	% needs to be called directly. Might be wrong...
	\c@pgfmath@counta#1\relax%
	\c@pgfmath@countb#1\relax%
	\divide\c@pgfmath@countb360\relax%
	\multiply\c@pgfmath@countb-360\relax%
	\c@pgfmath@counta#1\relax%
	\advance\c@pgfmath@counta\c@pgfmath@countb%
	\c@pgfmath@countb=90\relax%
	\advance\c@pgfmath@countb by-\c@pgfmath@counta%
	\ifnum\c@pgfmath@countb>179\relax%
		\advance\c@pgfmath@countb by-360\relax%
	\else%
		\ifnum\c@pgfmath@countb<-179\relax%
			\advance\c@pgfmath@countb by360\relax%
	\fi\fi%
	\ifnum\c@pgfmath@countb<0\relax%
 		\c@pgfmath@countb=-\c@pgfmath@countb%
	\fi%
	\expandafter\pgfmath@x\csname pgfmath@cos@\the\c@pgfmath@countb\endcsname pt\relax%
}

% \pgfmathcos
% 
% Calculate the cosine of #1 (in degrees).
%
\def\pgfmathcos#1{%
	\pgfmathparse{#1}%
	\expandafter\pgfmathcos@\expandafter{\pgfmathresult}}
\def\pgfmathcos@#1{%
	\begingroup%
		\pgfmath@x#1pt\relax%
		\afterassignment\pgfmath@gobbletilpgfmath@%
		\expandafter\c@pgfmath@counta\the\pgfmath@x\relax\pgfmath@%
		\pgfmath@xb\pgfmath@x%
		\advance\pgfmath@xb-\c@pgfmath@counta pt\relax%
		\expandafter\pgfmathcos@@\expandafter{\the\c@pgfmath@counta}%
		\pgfmath@xa\pgfmath@x%
		\ifnum\c@pgfmath@counta<180\relax%
			\advance\c@pgfmath@counta1\relax%
		\else
			\advance\c@pgfmath@counta-1\relax%
		\fi
		\expandafter\pgfmathcos@@\expandafter{\the\c@pgfmath@counta}%
		\pgfmath@x\pgfmath@tonumber{\pgfmath@xb}\pgfmath@x%
		\pgfmath@xb-\pgfmath@xb%
		\advance\pgfmath@xb1pt\relax%
		\advance\pgfmath@x\pgfmath@tonumber{\pgfmath@xb}\pgfmath@xa%
		\pgfmath@returnone\pgfmath@x%
	\endgroup%
}

\def\pgfmathcos@@#1{% NB No TeX group.
	\c@pgfmath@countb#1\relax%
	\divide\c@pgfmath@countb360\relax%
	\multiply\c@pgfmath@countb-360\relax%
	\c@pgfmath@counta#1\relax%
	\advance\c@pgfmath@counta\c@pgfmath@countb%
	\ifnum\c@pgfmath@counta<0\relax%
		\c@pgfmath@counta-\c@pgfmath@counta\relax%
	\fi%
	\ifnum\c@pgfmath@counta>179\relax%
		\c@pgfmath@countb360\relax%
		\advance\c@pgfmath@countb-\c@pgfmath@counta\relax%
		\c@pgfmath@counta\c@pgfmath@countb\relax%
	\fi%
	\expandafter\pgfmath@x\csname pgfmath@cos@\the\c@pgfmath@counta\endcsname pt\relax%
}
	
% \pgfmathtan
% 
% Calculate the cotangent of #1 (in degrees).
%
\def\pgfmathtan#1{%
	\pgfmathparse{#1}%
	\pgfmathtan@{\pgfmathresult}}
\def\pgfmathtan@#1{%
	\begingroup%
		\pgfmathcos@{#1}%
		\expandafter\pgfmathreciprocal@\expandafter{\pgfmathresult}%
		\edef\pgfmath@tantemp{\pgfmathresult}%
		\pgfmathsin@{#1}%
		\pgfmath@x\pgfmathresult pt\relax%
		\pgfmath@x\pgfmath@tantemp\pgfmath@x%
		\pgfmath@returnone\pgfmath@x%
	\endgroup%
}


% \pgfmatharcsin
%
% arcsin(x) = x + 1/2 (x^3/3) + (1/2)(3/4)(x^5/5) + (1/2)(3/4)(5/6)(x^7/7) + ... 
%
\def\pgfmatharcsin#1{%
	\pgfmathparse{#1}%
	\expandafter\pgfmatharcsin@\expandafter{\pgfmathresult}}
\def\pgfmatharcsin@#1{%
	\begingroup%
		\pgfmath@x#1pt\relax%
		\pgfmath@xa\pgfmath@tonumber{\pgfmath@x}\pgfmath@x%
		\pgfmath@xb\pgfmath@x%
		\pgfmath@ya16383.99999pt\relax%
		\pgfmath@y1pt\relax%
		\c@pgfmath@counta1\relax%
		\pgfmathloop%
			\multiply\pgfmath@y\c@pgfmath@counta%
			\advance\c@pgfmath@counta1\relax%
			\divide\pgfmath@y\c@pgfmath@counta%
			\advance\c@pgfmath@counta1\relax%
			\pgfmath@xb\pgfmath@tonumber{\pgfmath@xa}\pgfmath@xb%
			\pgfmath@xc\pgfmath@xb%
			\divide\pgfmath@xc\c@pgfmath@counta%
			\advance\pgfmath@x\pgfmath@tonumber{\pgfmath@y}\pgfmath@xc%
			\ifdim\pgfmath@x=\pgfmath@ya%
			\else%
				\pgfmath@ya=\pgfmath@x%
		\repeatpgfmathloop%
		\pgfmath@returnone\pgfmath@x%
	\endgroup%
}
	
\def\pgfmatharccos#1{%
	\pgfmathparse{#1}%
	\expandafter\pgfmatharccos@\expandafter{\pgfmathresult}}
\def\pgfmatharccos@#1{%
	\begingroup%
		\pgfmath@x\pgfmath@pi pt\relax%
		\divide\pgfmath@x2\relax%
		\pgfmatharcsin@{#1}%
		\advance\pgfmath@x-\pgfmathresult pt\relax%
		\pgfmath@returnone\pgfmath@x%
	\endgroup%
}
	
\def\pgfmath@def#1#2#3{\expandafter\def\csname pgfmath@#1@#2\endcsname{#3}}
\pgfmath@def{cos}{0}{1.00000}		\pgfmath@def{cos}{1}{0.99985}
\pgfmath@def{cos}{2}{0.99939}		\pgfmath@def{cos}{3}{0.99863}
\pgfmath@def{cos}{4}{0.99756}		\pgfmath@def{cos}{5}{0.99619}
\pgfmath@def{cos}{6}{0.99452}		\pgfmath@def{cos}{7}{0.99255}
\pgfmath@def{cos}{8}{0.99027}		\pgfmath@def{cos}{9}{0.98769}
\pgfmath@def{cos}{10}{0.98481}		\pgfmath@def{cos}{11}{0.98163}
\pgfmath@def{cos}{12}{0.97815}		\pgfmath@def{cos}{13}{0.97437}
\pgfmath@def{cos}{14}{0.97030}		\pgfmath@def{cos}{15}{0.96593}
\pgfmath@def{cos}{16}{0.96126}		\pgfmath@def{cos}{17}{0.95630}
\pgfmath@def{cos}{18}{0.95106}		\pgfmath@def{cos}{19}{0.94552}
\pgfmath@def{cos}{20}{0.93969}		\pgfmath@def{cos}{21}{0.93358}
\pgfmath@def{cos}{22}{0.92718}		\pgfmath@def{cos}{23}{0.92050}
\pgfmath@def{cos}{24}{0.91355}		\pgfmath@def{cos}{25}{0.90631}
\pgfmath@def{cos}{26}{0.89879}		\pgfmath@def{cos}{27}{0.89101}
\pgfmath@def{cos}{28}{0.88295}		\pgfmath@def{cos}{29}{0.87462}
\pgfmath@def{cos}{30}{0.86603}		\pgfmath@def{cos}{31}{0.85717}
\pgfmath@def{cos}{32}{0.84805}		\pgfmath@def{cos}{33}{0.83867}
\pgfmath@def{cos}{34}{0.82904}		\pgfmath@def{cos}{35}{0.81915}
\pgfmath@def{cos}{36}{0.80902}		\pgfmath@def{cos}{37}{0.79864}
\pgfmath@def{cos}{38}{0.78801}		\pgfmath@def{cos}{39}{0.77715}
\pgfmath@def{cos}{40}{0.76604}		\pgfmath@def{cos}{41}{0.75471}
\pgfmath@def{cos}{42}{0.74314}		\pgfmath@def{cos}{43}{0.73135}
\pgfmath@def{cos}{44}{0.71934}		\pgfmath@def{cos}{45}{0.70711}
\pgfmath@def{cos}{46}{0.69466}		\pgfmath@def{cos}{47}{0.68200}
\pgfmath@def{cos}{48}{0.66913}		\pgfmath@def{cos}{49}{0.65606}
\pgfmath@def{cos}{50}{0.64279}		\pgfmath@def{cos}{51}{0.62932}
\pgfmath@def{cos}{52}{0.61566}		\pgfmath@def{cos}{53}{0.60182}
\pgfmath@def{cos}{54}{0.58779}		\pgfmath@def{cos}{55}{0.57358}
\pgfmath@def{cos}{56}{0.55919}		\pgfmath@def{cos}{57}{0.54464}
\pgfmath@def{cos}{58}{0.52992}		\pgfmath@def{cos}{59}{0.51504}
\pgfmath@def{cos}{60}{0.50000}		\pgfmath@def{cos}{61}{0.48481}
\pgfmath@def{cos}{62}{0.46947}		\pgfmath@def{cos}{63}{0.45399}
\pgfmath@def{cos}{64}{0.43837}		\pgfmath@def{cos}{65}{0.42262}
\pgfmath@def{cos}{66}{0.40674}		\pgfmath@def{cos}{67}{0.39073}
\pgfmath@def{cos}{68}{0.37461}		\pgfmath@def{cos}{69}{0.35837}
\pgfmath@def{cos}{70}{0.34202}		\pgfmath@def{cos}{71}{0.32557}
\pgfmath@def{cos}{72}{0.30902}		\pgfmath@def{cos}{73}{0.29237}
\pgfmath@def{cos}{74}{0.27564}		\pgfmath@def{cos}{75}{0.25882}
\pgfmath@def{cos}{76}{0.24192}		\pgfmath@def{cos}{77}{0.22495}
\pgfmath@def{cos}{78}{0.20791}		\pgfmath@def{cos}{79}{0.19081}
\pgfmath@def{cos}{80}{0.17365}		\pgfmath@def{cos}{81}{0.15643}
\pgfmath@def{cos}{82}{0.13917}		\pgfmath@def{cos}{83}{0.12187}
\pgfmath@def{cos}{84}{0.10453}		\pgfmath@def{cos}{85}{0.08716}
\pgfmath@def{cos}{86}{0.06976}		\pgfmath@def{cos}{87}{0.05234}
\pgfmath@def{cos}{88}{0.03490}		\pgfmath@def{cos}{89}{0.01745}
\pgfmath@def{cos}{90}{0.00000}		\pgfmath@def{cos}{91}{-0.01745}
\pgfmath@def{cos}{92}{-0.03490}		\pgfmath@def{cos}{93}{-0.05234}
\pgfmath@def{cos}{94}{-0.06976}		\pgfmath@def{cos}{95}{-0.08716}
\pgfmath@def{cos}{96}{-0.10453}		\pgfmath@def{cos}{97}{-0.12187}
\pgfmath@def{cos}{98}{-0.13917}		\pgfmath@def{cos}{99}{-0.15643}
\pgfmath@def{cos}{100}{-0.17365}		\pgfmath@def{cos}{101}{-0.19081}
\pgfmath@def{cos}{102}{-0.20791}		\pgfmath@def{cos}{103}{-0.22495}
\pgfmath@def{cos}{104}{-0.24192}		\pgfmath@def{cos}{105}{-0.25882}
\pgfmath@def{cos}{106}{-0.27564}		\pgfmath@def{cos}{107}{-0.29237}
\pgfmath@def{cos}{108}{-0.30902}		\pgfmath@def{cos}{109}{-0.32557}
\pgfmath@def{cos}{110}{-0.34202}		\pgfmath@def{cos}{111}{-0.35837}
\pgfmath@def{cos}{112}{-0.37461}		\pgfmath@def{cos}{113}{-0.39073}
\pgfmath@def{cos}{114}{-0.40674}		\pgfmath@def{cos}{115}{-0.42262}
\pgfmath@def{cos}{116}{-0.43837}		\pgfmath@def{cos}{117}{-0.45399}
\pgfmath@def{cos}{118}{-0.46947}		\pgfmath@def{cos}{119}{-0.48481}
\pgfmath@def{cos}{120}{-0.50000}		\pgfmath@def{cos}{121}{-0.51504}
\pgfmath@def{cos}{122}{-0.52992}		\pgfmath@def{cos}{123}{-0.54464}
\pgfmath@def{cos}{124}{-0.55919}		\pgfmath@def{cos}{125}{-0.57358}
\pgfmath@def{cos}{126}{-0.58779}		\pgfmath@def{cos}{127}{-0.60182}
\pgfmath@def{cos}{128}{-0.61566}		\pgfmath@def{cos}{129}{-0.62932}
\pgfmath@def{cos}{130}{-0.64279}		\pgfmath@def{cos}{131}{-0.65606}
\pgfmath@def{cos}{132}{-0.66913}		\pgfmath@def{cos}{133}{-0.68200}
\pgfmath@def{cos}{134}{-0.69466}		\pgfmath@def{cos}{135}{-0.70711}
\pgfmath@def{cos}{136}{-0.71934}		\pgfmath@def{cos}{137}{-0.73135}
\pgfmath@def{cos}{138}{-0.74314}		\pgfmath@def{cos}{139}{-0.75471}
\pgfmath@def{cos}{140}{-0.76604}		\pgfmath@def{cos}{141}{-0.77715}
\pgfmath@def{cos}{142}{-0.78801}		\pgfmath@def{cos}{143}{-0.79864}
\pgfmath@def{cos}{144}{-0.80902}		\pgfmath@def{cos}{145}{-0.81915}
\pgfmath@def{cos}{146}{-0.82904}		\pgfmath@def{cos}{147}{-0.83867}
\pgfmath@def{cos}{148}{-0.84805}		\pgfmath@def{cos}{149}{-0.85717}
\pgfmath@def{cos}{150}{-0.86603}		\pgfmath@def{cos}{151}{-0.87462}
\pgfmath@def{cos}{152}{-0.88295}		\pgfmath@def{cos}{153}{-0.89101}
\pgfmath@def{cos}{154}{-0.89879}		\pgfmath@def{cos}{155}{-0.90631}
\pgfmath@def{cos}{156}{-0.91355}		\pgfmath@def{cos}{157}{-0.92050}
\pgfmath@def{cos}{158}{-0.92718}		\pgfmath@def{cos}{159}{-0.93358}
\pgfmath@def{cos}{160}{-0.93969}		\pgfmath@def{cos}{161}{-0.94552}
\pgfmath@def{cos}{162}{-0.95106}		\pgfmath@def{cos}{163}{-0.95630}
\pgfmath@def{cos}{164}{-0.96126}		\pgfmath@def{cos}{165}{-0.96593}
\pgfmath@def{cos}{166}{-0.97030}		\pgfmath@def{cos}{167}{-0.97437}
\pgfmath@def{cos}{168}{-0.97815}		\pgfmath@def{cos}{169}{-0.98163}
\pgfmath@def{cos}{170}{-0.98481}		\pgfmath@def{cos}{171}{-0.98769}
\pgfmath@def{cos}{172}{-0.99027}		\pgfmath@def{cos}{173}{-0.99255}
\pgfmath@def{cos}{174}{-0.99452}		\pgfmath@def{cos}{175}{-0.99619}
\pgfmath@def{cos}{176}{-0.99756}		\pgfmath@def{cos}{177}{-0.99863}
\pgfmath@def{cos}{178}{-0.99939}		\pgfmath@def{cos}{179}{-0.99985}
\pgfmath@def{cos}{180}{-1.00000}	