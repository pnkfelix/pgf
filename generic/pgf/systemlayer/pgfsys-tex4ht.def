\ProvidesFileRCS $Header: /cvsroot/pgf/pgf/generic/pgf/systemlayer/pgfsys-tex4ht.def,v 1.3 2005/07/10 17:54:32 tantau Exp $

% Copyright 2005 by Till Tantau <tantau@cs.tu-berlin.de>.
%
% This program can be redistributed and/or modified under the terms
% of the GNU Public License, version 2.




% Driver commands for tex4ht

%
% Load common pdf commands:
%
\input pgfsys-common-svg.def

%
% pdftex-specific stuff:
%
\def\pgfsys@invoke#1{\HCode{#1}}

\newcount\pgf@sys@svg@picnum

\def\pgfsys@beginpicture#1#2#3#4{%
  \global\advance\pgf@sys@svg@picnum by 1\relax%
  % Ok, compute width/height
  \pgf@x=#1%
  \pgf@x=-\pgf@x%
  \advance\pgf@x by#3%
  \pgf@y=#2%
  \pgf@y=-\pgf@y%
  \advance\pgf@y by#4%
  \HCode{<object data="\jobname-\the\pgf@sys@svg@picnum.svg"
    width="\the\pgf@x" height="\the\pgf@y"
  type="image/svg+xml"><p/></object>}%
  \special{t4ht>\jobname-\the\pgf@sys@svg@picnum.svg}%
  \pgfsys@invoke{<svg width="\the\pgf@x" height="\the\pgf@y" viewBox="}
  \pgf@sys@pt{#1}\pgf@sys@pt{#2}\pgf@sys@pt{#3}\pgf@sys@pt{#4}%
  \pgfsysprotocol@flushcurrentprotocol%
  \pgfsys@invoke{"> <g transform="translate(0,\the\pgf@y) scale(1,-1)"
  style="stroke:none;fill:none">}
  \edef\pgf@sys@svg@savedpicnum{\the\pgf@sys@svg@picnum}%
}
\def\pgfsys@endpicture{%
  \pgfsys@invoke{</g></svg>}%
  \special{t4ht<\jobname-\pgf@sys@svg@savedpicnum.svg}%
}

\def\pgfsys@beginhbox{\HCode{<text style="fill:black" transform="scale(1,-1)">}}
\def\pgfsys@endhbox{\HCode{</text>}}

\endinput


%%% Local Variables: 
%%% mode: latex
%%% End: 
