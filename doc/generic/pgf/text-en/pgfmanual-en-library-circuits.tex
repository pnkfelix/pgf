% Copyright 2008 by Till Tantau and Massimo Redaelli
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Free Documentation License.
%
% See the file doc/generic/pgf/licenses/LICENSE for more details.



\section{Circuit Libraries}
\label{section-library-circuits}

This section is still heavily under construction...

\subsection{Overview}

The circuit libraries can be used to draw different kinds of
electrical or logical circuits. There is not a single library for
this, but a whole hierarchy of libraries that work in concert. The
main design goal was to create a balance between easy-of-use and
easy-of-extending, while creating high-quality graphical
representations of circuits. Here is a first example:

\begin{codeexample}[]
\begin{tikzpicture}[circuit ee IEC,x=3cm,y=2cm,semithick,
                    every info/.style={font=\footnotesize},
                    resistor graphic=var resistor IEC graphic,
                    diode graphic=var diode IEC graphic]
  % Let us start with some links:
  \foreach \y in {1,...,5}
  {
    \node [link] (left link \y) at (0,\y) {};
    \node [link] (right link \y) at (1,\y) {};
  }
  \draw (right link 1) -- (right link 2) -- (right link 3)
     -- (right link 4) -- (right link 5);
  
  \draw (left link 1) to [diode] ++(down:1)
                      to [voltage source={near start,volt=3,direction info},
                          resistor={near end,ohm=3}] ++(right:1)
                      to (right link 1);
  \draw (left link 1) to [resistor={ohm=4}] (right link 1);
  \draw (left link 1) to [resistor={ohm=3}] (left link 2);
  \draw (left link 2) to [voltage source={near start,volt=8,direction info},
                          resistor={ohm=2,near end}] (right link 2);
  \draw (left link 2) to [resistor={ohm=1}] (left link 3);
  \draw (left link 3) to [resistor={info={$R=4\Omega$}}] (right link 3);
  \draw (left link 4) to [voltage source={near start,volt=8,direction info},
                          resistor={ohm=2,near end}] (right link 4);
  \draw (left link 3) to [resistor={ohm=1}] (left link 4);
  \draw (left link 4) to [resistor={ohm=3}] (left link 5);
  \draw (left link 5) to [resistor={ohm=4}] (right link 5);
  \draw (left link 5) to [diode] ++(up:1)
                      to [voltage source={near start,volt=3,direction info},
                          resistor={near end,ohm=3}] ++(right:1)
                      to (right link 5);
\end{tikzpicture}
\end{codeexample}

An important feature of the circuit library is that the appearance of
a circuit can be configured in general ways and that the labels are
placed automatically by default. Here is the graphic once more,
generated from \emph{exactly the same source code}, with only
the options of the |{tikzpicture}| environment replaced by
|[rotate=-90,circuit ee IEC,x=3.25cm,y=2.25cm,semithick]|:

\begin{tikzpicture}[rotate=-90,circuit ee IEC,x=3cm,y=2.25cm,semithick]
  % Let us start with some links:
  \foreach \y in {1,...,5}
  {
    \node [link] (left link \y) at (0,\y) {};
    \node [link] (right link \y) at (1,\y) {};
  }
  \draw (right link 1) -- (right link 2) -- (right link 3)
     -- (right link 4) -- (right link 5);
  
  \draw (left link 1) to [diode] ++(down:1)
                      to [voltage source={near start,volt=3,direction info},
                          resistor={near end,ohm=3}] ++(right:1)
                      to (right link 1);
  \draw (left link 1) to [resistor={ohm=4}] (right link 1);
  \draw (left link 1) to [resistor={ohm=3}] (left link 2);
  \draw (left link 2) to [voltage source={near start,volt=8,direction info},
                          resistor={ohm=2,near end}] (right link 2);
  \draw (left link 2) to [resistor={ohm=1}] (left link 3);
  \draw (left link 3) to [resistor={info={$R=4\Omega$}}] (right link 3);
  \draw (left link 4) to [voltage source={near start,volt=8,direction info},
                          resistor={ohm=2,near end}] (right link 4);
  \draw (left link 3) to [resistor={ohm=1}] (left link 4);
  \draw (left link 4) to [resistor={ohm=3}] (left link 5);
  \draw (left link 5) to [resistor={ohm=4}] (right link 5);
  \draw (left link 5) to [diode] ++(up:1)
                      to [voltage source={near start,volt=3,direction info},
                          resistor={near end,ohm=3}] ++(right:1)
                      to (right link 5);
\end{tikzpicture}

A circuit typically consists of numerous electronic elements lke
logical gates or resistors or diodes that are connected by wires. In
\pgfname/\tikzname, we use nodes for the 
electronic elements and normal lines for the wires. \tikzname\ offers
a large number of different ways of positioning and connecting nodes
in general, all of which can be used here. Additionally, the
|circuits| library defines an additional useful |to|-path that is
particularly useful for elements like a resistor on a line.

There are many different names that are used to refer to electrical
``elements,'' so a bit of terminology standardization is useful: We
will call such elements \emph{symbols}. A \emph{symbol shape} is a
\pgfname\ shape declared using the |\pgfdeclareshape| command. A
\emph{symbol node} is a node whose shape is a symbol shape.

Symbols can be created by 
|\node[shape=some symbol shape]|. However, in order to represent some
symbols correctly, just using standard \pgfname\ shapes is not
sufficient. For instance, most symbols have a visually appealing
``default size,'' but the size of a symbol shape depends only on the
current values of parameters like |minimum height| or |inner xsep|.

For these reasons, the circuit libraries introduce the concept of a
\emph{symbol graphic}. This is a style that causes a |\node| to
not only have the correct shape, but also the correct size and the
correct path usage. More generally, this style may setup things in any
way so that the ``symbol looks correct''. When you write, for
instance, |\node[diode]|, then the style called |diode graphic| is
used, which in turn is set to something like
|shape=diode IEC,draw,minimum height=...|.

Here is an overview of the different kinds of circuit libraries:

\begin{itemize}
\item The \pgfname-libraries |shapes.gates.*| define (circuit) symbol
  shapes. However, you normally do not use these shapes directly,
  rather you use a style that uses an appropriate symbol graphic,
  which in turn uses one of these shapes.
\item The \tikzname-library |circuits| defines general keys for
  creating circuits. Mostly, these keys are useful for defining more
  specialized libraries.

  You normally do not use this library directly since it does not
  define any symbol graphics.
\item The \tikzname-library |circuits.logic| defines keys for creating
  logical gates like and-gates or xor-gates. However, this library
  also does not actually define any symbol graphics; this is done by
  two sublibraries:
  \begin{itemize}
  \item The library |circuits.logic.US| defines symbol graphics that
    cause the logical gates to be rendered in the ``US-style.'' It
    includes all of the above libraries and you can use this library
    directly.
  \item The library |circuits.logic.IEC| also defines symbol graphics
    for logical gates, but it uses rectangular gates rather that the
    round US-gates. This library can coexist peacefully with the above
    library, you can change which symbol graphics are used ``on the
    fly.'' 
  \end{itemize}
\item The \tikzname-library |cirucits.ee| defines keys for symbols
  from electrical engineering like resistors or capacitors. Again,
  sublibraries define the actual symbol graphics.
  \begin{itemize}
  \item The library |circuits.ee.IEC| defines symbol shapes that
    follow the IEC norm.
  \end{itemize}
\end{itemize}

Let us have a look at a simple example. Suppose we wish to create a
logical circuit. Then we first have to decide which symbol graphics we
would like to use. Suppose we wish to use the US-style, then we would
include the library |circuits.logic.US|. If you wish to use IEC-style
symbols, use |circuits.logic.IEC|. If you cannot decide, include both:
\begin{codeexample}[code only]
\usetikzlibrary{circuits.logic.US,circuits.logic.IEC}
\end{codeexample}
To create a picture that contains a US-style circuit you can now use
the option |circuit logic US|. This will setup keys like |and gate| to
create use an appropriate symbol graphic for rendering an and
gate. Using the |circuit logic IEC| instead will setup |and gate| to
use another symbol graphic.

\begin{codeexample}[]
\begin{tikzpicture}[circuit logic US]
  \matrix[column sep=7mm]
  {
    \node (i0) {0}; &                            & \\
                    & \node [and gate] (a1) {};  & \\
    \node (i1) {0}; &                            & \node [or gate] (o) {};\\
                    & \node [nand gate] (a2) {}; & \\
    \node (i2) {1}; &                            & \\
  };
  \draw (i0.east) -- ++(right:3mm) |- (a1.input 1);
  \draw (i1.east) -- ++(right:3mm) |- (a1.input 2);
  \draw (i1.east) -- ++(right:3mm) |- (a2.input 1);
  \draw (i2.east) -- ++(right:3mm) |- (a2.input 2);
  \draw (a1.output) -- ++(right:3mm) |- (o.input 1);
  \draw (a2.output) -- ++(right:3mm) |- (o.input 2);
  \draw (o.output) -- ++(right:3mm);
\end{tikzpicture}
\end{codeexample}


\begin{codeexample}[]
\begin{tikzpicture}[circuit logic IEC]
  \matrix[column sep=7mm]
  {
    \node (i0) {0}; &                            & \\
                    & \node [and gate] (a1) {};  & \\
    \node (i1) {0}; &                            & \node [or gate] (o) {};\\
                    & \node [nand gate] (a2) {}; & \\
    \node (i2) {1}; &                            & \\
  };
  \draw (i0.east) -- ++(right:3mm) |- (a1.input 1);
  \draw (i1.east) -- ++(right:3mm) |- (a1.input 2);
  \draw (i1.east) -- ++(right:3mm) |- (a2.input 1);
  \draw (i2.east) -- ++(right:3mm) |- (a2.input 2);
  \draw (a1.output) -- ++(right:3mm) |- (o.input 1);
  \draw (a2.output) -- ++(right:3mm) |- (o.input 2);
  \draw (o.output) -- ++(right:3mm);
\end{tikzpicture}
\end{codeexample}


\subsection{The Base Circuit Library}

\begin{tikzlibrary}{circuits}
  This library is a base library that is included by other circuit
  libraries. You do not use it ``yourself.''
\end{tikzlibrary}

\begin{key}{/tikz/circuits}
  This key should be passed as an option to a picture or a scope that
  contains a circuit. It will do some internal setups. This key is
  normally called by more specialized keys like |circuit ee IEC|.
\end{key}

\subsubsection{Symbol Size}

\begin{key}{/tikz/circuit symbol unit=\meta{dimension} (intially 7pt)}
  To be written...
\end{key}

\begin{stylekey}{/tikz/huge circuit symbols}
  To be written...
\end{stylekey}
\begin{stylekey}{/tikz/large circuit symbols}
  To be written...
\end{stylekey}
\begin{stylekey}{/tikz/medium circuit symbols}
  To be written...
\end{stylekey}
\begin{stylekey}{/tikz/small circuit symbols}
  To be written...
\end{stylekey}
\begin{stylekey}{/tikz/tiny circuit symbols}
  To be written...
\end{stylekey}

\begin{key}{/tikz/circuit symbol size=|width| \meta{width} |height|
    \meta{height}} 
  To be written.
\end{key}

\subsubsection{Declaring New Symbols}

\begin{key}{/tikz/circuit declare symbol=\meta{name}}
  To be written...
  \begin{stylekey}{/tikz/every circuit symbol}
    To be written...
  \end{stylekey}
\end{key}


\begin{key}{/tikz/circuit handle symbol=\meta{options}}
  To be written...
\end{key}


\subsubsection{Info Labels}

\begin{key}{/tikz/info=}
  To be written...
\end{key}

\begin{key}{/tikz/info'=}
  To be written...
\end{key}

\begin{key}{/tikz/info sloped=}
  To be written...
\end{key}

\begin{key}{/tikz/info' sloped=}
  To be written...
\end{key}

\begin{key}{/tikz/circuit declare unit=\marg{name}\marg{unit}}
  To be written...
\end{key}

\subsection{Logical Circuits}


\begin{tikzlibrary}{circuits.logical}
  This library defines the basic logical gate symbols, but does not
  provide the symbol graphics.
\end{tikzlibrary}


\subsubsection{Usage}

\subsubsection{US-Style Symbol Graphics}

\subsubsection{IEC-Style Symbol Graphics}

\subsubsection{The Underlying Shape Libraries}


Cleanup the following...

\pgfname{} provides two libraries of logic gates, one providing
``American'' style gates and the other, providing ``rectangular'' 
logic gates.	
Each library suffixes the gate names with an identifer:
|US| for the American style gates, and |IEC| for the rectangular
gates (additionally, two shapes in the |US| library use the
suffix |CDH|). Keys which are specific
to a particular library	also contain this identifier (e.g., 
|/pgf/and gate IEC symbol|).
However, as described below, a \tikzname{} key is provided which
sets up several styles allowing the identifier to be omitted,
for example, |and gate| can become a synonym for |shape=and gate US|.

Multiple inputs can be specified for a logic gate (provided they
support multiple inputs: a not gate --- also known as an inverter ---
does not). However, there is an upper limit for the number of inputs 
which has been set at 1024, which should be \emph{way} 
more than would ever be needed.

There are some \pgfname{} keys which are common to both 
libraries, which have no library identifier contained in them:
 
\begin{key}{/pgf/logic gate inputs=\meta{input list} (initially \char`\{normal,normal\char`\})}
  Specify the inputs for for the logic gate. The keyword |inverted|
  indicates an inverted input which will mean \pgfname{} will draw a
  circle attached to the main shape of the logic gate. Any keyword
  that is not |inverted| will be treated as a ``normal'' or 
  ``non-inverted'' input (however, for readability, you may wish to 
  use |normal| or |non-inverted|), and \pgfname{} will not draw the 
  circle.  
  In both cases the anchors for the inputs will be set 
  up appropriately, numbered from top to bottom |input 1|, |input 2|,
  \ldots and so on. If the gate only supports one input the anchor
  is simply called |input| with no numerical index.
  
\begin{codeexample}[]
\begin{tikzpicture}[minimum height=0.75cm]
  \node[and gate IEC, draw, logic gate inputs={inverted, normal, inverted}] 
  (A) {};
  \foreach \a in {1,...,3}
    \draw (A.input \a -| -1,0) -- (A.input \a);
  \draw (A.output) -- ([xshift=0.5cm]A.output);
\end{tikzpicture}
\end{codeexample} 
  
  For multiple inputs it may be somewhat unweildy to specify a long
  list, thus, the following ``shorthand'' is permitted (this is an  
  extension of ideas due to Juergen Werber and Christoph Bartoschek):
  Using |i| for inverted and |n| for normal inputs, \meta{input list}
  can be specfied \emph{without the commas}. So, for example,
  |ini| is equivalent to |inverted, normal, inverted|.
  
\begin{codeexample}[]
\begin{tikzpicture}[minimum height=0.75cm]
  \node[or gate US, draw,logic gate inputs=inini] (A) {};
  \foreach \a in {1,...,5}
    \draw (A.input \a -| -1,0) -- (A.input \a);
  \draw (A.output) -- ([xshift=0.5cm]A.output);
\end{tikzpicture}
\end{codeexample} 
 
\end{key}


The height of the gate may be increased to accommodate the number 
of inputs. In fact, it depends on three variables:
$n$, the number of inputs, $r$, the radius of the circle used
to indicate an inverted input and $s$, the distance between
the centers of the inputs.
The default height is then calculated according to the expression 
$(n+1)\times\max(2r,s)$. This then may
be increased to accommodate the node contents or any
minimum size specifications.

The radius of the inverted input circle and the distance between the 
centers of the inputs can be customised using the following keys:

\begin{key}{/pgf/logic gate inverted radius=\meta{length} (initially 2pt)}
  Set the radius of the circle that is used to indicate inverted
  inputs. This is also the radius of the circle used for the inverted
  output of the |nand|, |nor|, |xnor| and |not| gates. 
    
\begin{codeexample}[]
\begin{tikzpicture}[minimum height=0.75cm]
  \tikzset{every node/.style={shape=nand gate CDH, draw, logic gate inputs=ii}}
  \node[logic gate inverted radius=2pt] {A};
  \node[logic gate inverted radius=4pt] at (0,-1) {B};
\end{tikzpicture}
\end{codeexample} 
\end{key}

\begin{key}{/pgf/logic gate input sep=\meta{length} (initially .125cm)}
  Set the distance between the \emph{centers} of the inputs to the
  logic gate. 
  
\begin{codeexample}[]
\begin{tikzpicture}[minimum size=0.75cm]
  \draw [help lines] grid (3,2);
  \tikzset{every node/.style={shape=and gate IEC, draw, logic gate inputs=ini}}
  \node[logic gate input sep=0.33333cm] at (1,1)(A) {A};
  \node[logic gate input sep=0.5cm]     at (3,1) (B) {B};
  \foreach \a in {1,...,3}
    \draw (A.input \a -| 0,0) -- (A.input \a)
          (B.input \a -| 2,0) -- (B.input \a);
\end{tikzpicture}
\end{codeexample} 
\end{key}



\begin{pgflibrary}{shapes.gates.logic.US}
  This library provides ``American'' logic gate shapes whose names are 
  suffixed with the identifier |US|. Additionally,
  alternative |and| and |nand| gates are provided which are based on the 
  logic symbols used in A. Croft, R. Davidson, and M. Hargreaves (1992), 
  \emph{Engineering Mathematics}, Addison-Wesley, 82--95. These two 
  shapes are suffixed with |CDH|. 
\end{pgflibrary}

To use the shapes in \tikzname{} without their suffixes, the 
following keys are provided:
  
\begin{key}{/tikz/use US style logic gates}
  This allows the the shapes suffixed with |US| to be used without
  the suffix. So, for example, |and gate| becomes a synonym for
  |shape=and gate US|.
\begin{codeexample}[]
\tikz\node[draw, and gate US, red]{and};
\space
\tikz[use US style logic gates,blue]\node[draw, and gate]{and};
\end{codeexample}
\end{key}

\begin{key}{/tikz/use CDH style logic gates}
  This key again allows the the shapes suffixed with |US| to be used 
  without the |US| suffix. However, |and gate| becomes a synonym for
  |shape=and gate CDH| and |nand gate| becomes a synonym for
  |shape=nand gate CDH|, providing alternative symbols for these
  gates.
	
\begin{codeexample}[]
\begin{tikzpicture}[minimum height=1cm]
  \node[draw, and gate US, red]  at  (0,1.5) {and};
  \node[draw, nand gate US, red] at (2,1.5) {nand};
  \tikzset{use CDH style logic gates}
  \node[draw, and gate, blue]  at (0,0) {and};
  \node[draw, nand gate, blue] at (2,0) {nand};
\end{tikzpicture}
\end{codeexample}
\end{key}


As described above, \pgfname{} will increase the size of the 
logic gate to accommodate the number of inputs, and the size
of the inverted radius and the separation between the inputs.
However with all shapes in this library, any increase in size 
(including any minimum size requirements) will be applied so that 
the default aspect ratio is unaltered. This means that changing
the height will change the width and vice versa. 

The ``compass point'' anchors apply to the main part of the shape
and do not include any inverted inputs or outputs. This library
provides an additonal feature to facilitate the relative positioning
of logic gates:

\begin{key}{/pgf/logic gate anchors use bounding box=\meta{boolean} (initially false)}
  When set to |true| this key will ensure that the 
  compass point anchors use the bounding rectangle of the
  main shape, which, ignore any inverted inputs or outputs, but
  includes any |outer sep|. 
  This \emph{only} affects the compass point anchors
  and is not set on a shape by shape basis: whether the bounding
  box is used is determined by value of this key when the anchor
  is accessed.

\begin{codeexample}[]
\begin{tikzpicture}[minimum height=1.5cm]
  \node[xnor gate US, draw, gray!50,line width=2pt] (A) {};
  \foreach \x/\y/\z in {false/blue/1pt, true/red/2pt}
    \foreach \a in {north, south, east, west, north east, 
      south east, north west, south west}
      \draw[logic gate anchors use bounding box=\x, color=\y]	
        (A.\a) circle(\z);
\end{tikzpicture}
\end{codeexample} 

\end{key}




\begin{shape}{and gate US}
  This shape is an and gate which supports two or more inputs. If
  less than two inputs are specified an error will result. 
  The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=and gate US,shape example, inner sep=0cm,
    logic gate inverted radius=.5cm] {And Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/right, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/right, input 1/above, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}
\end{shape}

\begin{shape}{nand gate US}
  This shape is a nand gate, which supports two or more inputs. If
	less than two inputs are specified an error will result. 
	The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.
 
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=nand gate US,shape example, inner sep=0cm,
  logic gate inverted radius=.5cm] {Nand Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/right, input 1/above, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}

\end{shape}

\begin{shape}{or gate US}

	This shape is an or gate, which supports two or more inputs. If
	less than two inputs are specified an error will result. 
	The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=or gate US,shape example, inner sep=0cm,
  logic gate inverted radius=.5cm] {Or Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/right, input 1/left, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}
\end{shape}

\begin{shape}{nor gate US}
	This shape is a nor gate, which supports two or more inputs. If
	less than two inputs are specified an error will result. 
	The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.

\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=nor gate US,shape example, inner sep=0cm,
  logic gate inverted radius=.5cm] {Nor Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/right, input 1/left, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}

\end{shape}

\begin{shape}{xor gate US}
  This shape is an xor gate, which supports only two inputs. If
  less than two inputs are specified an error will result. If more
  than two inputs are specified, the extra inputs are ignored.
  The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=xor gate US,shape example, inner sep=0cm,
    logic gate inverted radius=.5cm] {Xor Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/right, input 1/above, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}

\end{shape}

\begin{shape}{xnor gate US}

	This shape is an xnor gate, which supports only two inputs. If
	less than two inputs are specified an error will result. If more
	than two inputs are specified, the extra inputs are ignored.
	The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=xnor gate US,shape example, inner sep=0cm,
  logic gate inverted radius=.5cm] {Xnor Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/above, input 1/above, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}


\end{shape}

\begin{shape}{not gate US}
	This shape is a not gate, which supports only one input. If
	no inputs are specified an error will result. If more
	than one input is specified, the extra inputs are ignored.
	The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=not gate US,shape example, inner sep=1.5cm,
  logic gate inverted radius=.5cm] 
  {Not Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/below,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/above}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}

\end{shape}

\begin{shape}{buffer gate US}
	This shape is a not gate, which supports only one input. If
	no inputs are specified an error will result. If more
	than one input is specified, the extra inputs are ignored.
	The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=buffer gate US,shape example, inner sep=1.5cm,
  logic gate inverted radius=.5cm] 
  {Buffer Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/below,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}

\end{shape}





\begin{shape}{and gate CDH}
  This shape is the alternative and gate. It supports two or more inputs.
  If less than two inputs are specified an error will result. 
	The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=and gate CDH,shape example, inner sep=0cm,
    logic gate inverted radius=.5cm] {And Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/right, input 1/above, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}
\end{shape}

\begin{shape}{nand gate CDH}
  This shape is the alternative nand gate. It supports two or more inputs.
  If less than two inputs are specified an error will result. 
	The anchors for this gate with two
  non-inverted inputs (using the normal compass point anchors) are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=nand gate CDH,shape example, inner xsep=0cm,
    logic gate inverted radius=.5cm] {Nand Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/right, input 1/above, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}

\end{shape}



\begin{pgflibrary}{shapes.gates.logic.IEC}
  This library provides rectangular logic gate shapes. These shapes
  are suffixed with |IEC| as they are based on gates recommended by
  the International Electrotechincal Commission.
\end{pgflibrary}

  In order to use these shapes in \tikzname{} without the |IEC|
  suffix, the following key is provided:
  
\begin{key}{/tikz/use IEC style logic gates}
	This allows the the shapes suffixed with |IEC| to be used without
	the suffix. So, for example, |and gate| becomes a synonym for
	|shape=and gate IEC|. In addtion the |IEC| specific keys can be
	used without |IEC|, so |and gate symbol| can be
	used for |and gate IEC symbol|.
\end{key}

  By default each gate is drawn with a symbol, $\char`\&$ for |and| and 
  |nand| gates, $\geq1$ for |or| and |nor| gates, $1$ for |not| and 
  |buffer| gates, and $=1$ for |xor| and |xnor| gates. These symbols 
  are drawn automatically (internally they are drawn using the 
  ``foreground'' path), and are not strictly speaking part of the node
  contents. However, the gate is enlarged to make sure the symbols are 
  within the border of the node.
  It is possible to change
  the symbols and their position within the node using the following
  keys:
  
\begin{key}{/pgf/and gate IEC symbol=\meta{text} (initially \char`\\char\char`\`\char`\\\char`\&)}
  Set the symbol for the |and gate|. Note that if the node is filled,
  this color will be used for the symbol, making it invisible, so
  it will be necessary set \meta{text} to something like
  |\color{black}\char`\&|. Alternatively, the 
  |logic gate IEC symbol color| key can be used to set the color
  of all symbols simultaneously.
  
  In \tikzname, when the |use IEC style logic gates| key has been 
  used, this key can be replaced by |and gate symbol|.
\end{key}

\begin{key}{/pgf/nand gate IEC symbol=\meta{text} (initially \char`\\char\char`\`\char`\\\char`\&)}
  Set the symbol for the |nand gate|.  
  In \tikzname, when the |use IEC style logic gates| key has been 
  used, this key can be replaced by |nand gate symbol|.
\end{key}

\begin{key}{/pgf/or gate IEC symbol=\meta{text} (initially \char`\$\char`\\geq1\char`\$)}
  Set the symbol for the |or gate|.  
  In \tikzname, when the |use IEC style logic gates| key has been 
  used, this key can be replaced by |or gate symbol|.
\end{key}

\begin{key}{/pgf/nor gate IEC symbol=\meta{text} (initially \char`\$\char`\\geq1\char`\$)}
  Set the symbol for the |nor gate|.  
  In \tikzname, when the |use IEC style logic gates| key has been 
  used, this key can be replaced by |nor gate symbol|.
\end{key}

\begin{key}{/pgf/xor gate IEC symbol=\meta{text} (initially \char`\{\char`\$=1\char`\$\char`\})}
  Set the symbol for the |xor gate|. Note the necessity for braces,
  as the symbol contains |=|.
  In \tikzname, when the |use IEC style logic gates| key has been 
  used, this key can be replaced by |or gate symbol|.
\end{key}

\begin{key}{/pgf/xnor gate IEC symbol=\meta{text} (initially  \char`\{\char`\$=1\char`\$\char`\})}
  Set the symbol for the |xnor gate|.  
  In \tikzname, when the |use IEC style logic gates| key has been 
  used, this key can be replaced by |xnor gate symbol|.
\end{key}

\begin{key}{/pgf/not gate IEC symbol=\meta{text} (initially 1)}
  Set the symbol for the |not gate|.  
  In \tikzname, when the |use IEC style logic gates| key has been 
  used, this key can be replaced by |not gate symbol|.
\end{key}

\begin{key}{/pgf/buffer gate IEC symbol=\meta{text} (initially 1)}
  Set the symbol for the |buffer gate|.  
  In \tikzname, when the |use IEC style logic gates| key has been 
  used, this key can be replaced by |buffer gate symbol|.
\end{key}

\begin{key}{/pgf/logic gate IEC symbol align=\meta{align} (initially top)}
  Set the alignment of the logic gate symbol (in \tikzname, when the 
  |use IEC style logic gates| key has been used, |IEC| can be omitted.
  The specification in \meta{align} is a comma separated list from
  |top|, |bottom|, |left| or |right|. The distance between the border
  of the node and the outer edge of the symbol is determined by the values 
  of the |inner xsep| and |inner ysep|.
  
\begin{codeexample}[]
\begin{tikzpicture}[minimum size=1cm, use IEC style logic gates]
	\tikzset{every node/.style={nor gate, draw}}
  \node (A) at (0,1.5) {};
  \node [logic gate symbol align={bottom, right}] (B) at (0,0) {}; 
  \foreach \g in {A, B}{
    \foreach \i in {1,2}
      \draw ([xshift=-0.5cm]\g.input \i) -- (\g.input \i);
    \draw (\g.output) -- ([xshift=0.5cm]\g.output);
  }
\end{tikzpicture}
\end{codeexample} 

\end{key}


\begin{key}{/pgf/logic gate IEC symbol color=\meta{color}}
  This key sets the color for all symbols simultaneously. This color
  can be overridden on a case by case basis by specifying a color
  when seting the symbol text.
\end{key}


\begin{shape}{and gate IEC}
  This shape is an and gate. It supports two or more inputs.
  If less than two inputs are specified an error will result. 
	The anchors for this gate with two
  non-inverted inputs are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=and gate IEC ,shape example, inner xsep=1cm, inner ysep=1cm,
    minimum height=6cm, and gate IEC symbol=\color{black!30}\char`\&] 
  {And Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/right, input 1/above, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}
\end{shape}


\begin{shape}{nand gate IEC}
  This shape is a nand gate. It supports two or more inputs.
  If less than two inputs are specified an error will result. 
	The anchors for this gate with two
  non-inverted inputs are
  shown below. Anchor |30| is an example of a border anchor.
  
\begin{codeexample}[]
\Huge
\begin{tikzpicture}
  \node[name=s,shape=nand gate IEC ,shape example, inner xsep=1cm, inner ysep=1cm,
    minimum height=6cm, nand gate IEC symbol=\color{black!30}\char`\&,
    logic gate inverted radius=0.65cm] 
  {Nand Gate\vrule width1pt height2cm};
  \foreach \anchor/\placement in
    {center/above, text/above, 30/above right,
     mid/right, mid east/left, mid west/above,
     base/below, base east/below, base west/left,
     north/above, south/below, east/above, west/above,
     north east/above, south east/below, south west/below, north west/above,
     output/right, input 1/above, input 2/below}
     \draw[shift=(s.\anchor)] plot[mark=x] coordinates{(0,0)}
       node[\placement] {\scriptsize\texttt{(s.\anchor)}};
\end{tikzpicture}
\end{codeexample}
\end{shape}

\begin{shape}{or gate IEC}
  This shape is an or gate. It supports two or more inputs.
  If less than two inputs are specified an error will result. 
	See the |and gate IEC| shape for the anchors.
	
\begin{codeexample}[]
\begin{tikzpicture}[minimum width=.875cm, minimum height=1cm]
  \node[or gate IEC, draw, logic gate inputs=in] (A) {};
  \draw (A.input 1 -| -1,0) -- (A.input 1) (A.input 2 -| -1,0) -- (A.input 2)
        (A.output) -- ([xshift=0.5cm]A.output);
\end{tikzpicture}
\end{codeexample} 

\end{shape}


\begin{shape}{nor gate IEC}
  This shape is an nor gate. It supports two or more inputs.
  If less than two inputs are specified an error will result. 
	See the |nand gate IEC| shape for the anchors.
	
\begin{codeexample}[]
\begin{tikzpicture}[minimum width=.875cm, minimum height=1cm]
  \node[nor gate IEC, draw, logic gate inputs=in] (A) {};
  \draw (A.input 1 -| -1,0) -- (A.input 1) (A.input 2 -| -1,0) -- (A.input 2)
        (A.output) -- ([xshift=0.5cm]A.output);
\end{tikzpicture}
\end{codeexample}

\end{shape}

\begin{shape}{xor gate IEC}
  This shape is an xor gate. It supports only two inputs.
   If less than two inputs are specified an error will result.
  Any extra inputs are ignored.  
		See the |and gate IEC| shape for the anchors.
	
\begin{codeexample}[]
\begin{tikzpicture}[minimum width=.875cm, minimum height=1cm]
  \node[xor gate IEC, draw, logic gate inputs=in] (A) {};
  \draw (A.input 1 -| -1,0) -- (A.input 1) (A.input 2 -| -1,0) -- (A.input 2)
        (A.output) -- ([xshift=0.5cm]A.output);
\end{tikzpicture}
\end{codeexample}

\end{shape}


\begin{shape}{xnor gate IEC}
  This shape is an xnor gate. It supports only two inputs.
  If less than two inputs are specified an error will result.
  Any extra inputs are ignored.  
	See the |nand gate IEC| shape for the anchors.
	
\begin{codeexample}[]
\begin{tikzpicture}[minimum width=.875cm, minimum height=1cm]
  \node[xnor gate IEC, draw, logic gate inputs=in] (A) {};
  \draw (A.input 1 -| -1,0) -- (A.input 1) (A.input 2 -| -1,0) -- (A.input 2)
        (A.output) -- ([xshift=0.5cm]A.output);
\end{tikzpicture}
\end{codeexample}

\end{shape}

\begin{shape}{buffer gate IEC}
   This shape is a buffer gate. It supports only one input.
  If less than one input is specified an error will result.
  Any extra inputs are ignored. 
	See the |and gate IEC| shape for the anchors.

\begin{codeexample}[]
\begin{tikzpicture}[minimum width=.875cm, minimum height=1cm]
  \node[buffer gate IEC, draw] (A) {};
  \draw (A.input -| -1,0) -- (A.input) (A.output) -- ([xshift=0.5cm]A.output);
\end{tikzpicture}
\end{codeexample}

\end{shape}


\begin{shape}{not gate IEC}
  This shape is a not gate. It supports only one input.
  If less than one input is specified an error will result.
  Any extra inputs are ignored. 
  See the |nand gate IEC| shape for the anchors.

\begin{codeexample}[]
\begin{tikzpicture}[minimum width=.875cm, minimum height=1cm]
  \node[not gate IEC, draw] (A) {};
  \draw (A.input -| -1,0) -- (A.input) (A.output) -- ([xshift=0.5cm]A.output);
\end{tikzpicture}
\end{codeexample}


\end{shape}





\subsection{Electrical Engineering Circuits}

\subsubsection{Usage}

\subsubsection{IEC-Style Symbol Graphics}

\subsubsection{The Underlying Shape Libraries}




\endinput



