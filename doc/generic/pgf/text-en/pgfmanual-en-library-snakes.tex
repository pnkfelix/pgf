% Copyright 2006 by Till Tantau
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Free Documentation License.
%
% See the file doc/generic/pgf/licenses/LICENSE for more details.


\section{Snake Library}

\label{section-library-snakes}

\begin{pgflibrary}{snakes}
  This library package defines basic snakes plus a ``shape snake''
  contributed by Mark Wibrow.
  Section~\ref{section-tikz-snakes} explains how snakes are
  used in \tikzname, Section~\ref{section-base-snakes} explains how
  new snakes can be defined.

  The snakes are influenced by the current values of parameters like
  |\pgfsnakesegmentamplitude|. Only this parameter and
  |\pgfsnakesegmentlength| are proper \TeX\ dimensions, all other
  parameters are \TeX\ macros.

  In \tikzname, each parameter can be set using an option having the
  parameters name minus the |\pgfsnake| part.
\end{pgflibrary}


\begin{snake}{bent}
  This snake adds a slightly bent line from the start to the
  target. The amplitude of the bent is given by the segement amplitude
  (and amplitude of zero gives a straight line). 
  \begin{itemize}
  \item |\pgfsnakesegmentamplitude|
    determines the amplitude of the bent.
  \item |\pgfsnakesegmentaspect|
    determines how tight the bent is. A good value is around |0.3|. 
  \end{itemize}
\begin{codeexample}[]
\begin{tikzpicture}[segment aspect=.3]
  \node[circle,draw] (A) at (.5,.5) {A};
  \node[circle,draw] (B) at (3,1.5) {B};
  \draw[->,snake=bent,raise snake=2pt] (A) -- (B);
  \draw[->,snake=bent,raise snake=2pt] (B) -- (A);

  \draw [snake=bent,mirror snake] (0,0) rectangle (3.5,2);
\end{tikzpicture}
\end{codeexample}
\end{snake}



\begin{snake}{border}
  This snake adds straight lines the path that are at a specific angle
  to the line toward the target. The idea is to add these little lines
  to indicate the ``border'' or an area. The following parameters
  influence the snake:  
  \begin{itemize}
  \item |\pgfsnakesegmentlength|
    determines the distance between consecutive ticks.
  \item |\pgfsnakesegmentamplitude|
    determines the length of the ticks.
  \item |\pgfsnakesegmentangle|
    determines the angle between the ticks and the line toward the
    target. 
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw (0,0) rectangle (3,1)
            [snake=border,segment angle=-45] (0,0) rectangle (3,1);}
\end{codeexample}
\end{snake}


\begin{snake}{brace}
  This snake adds a long brace to the path. The left and right end of
  the brace will be exactly on the start and endpoint of the
  snake. The following parameters influence the snake:  
  \begin{itemize}
  \item |\pgfsnakesegmentamplitude|
    determines how much the brace rises above the path.
  \item |\pgfsnakesegmentaspect|
    determines the fraction of the total length where the ``middle
    part'' of the brace will be.  
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=brace,segment aspect=0.25] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}

\begin{snake}{bumps}
  This snake consists of little half ellipses. The following parameters
  influence the snake:
  \begin{itemize}
  \item |\pgfsnakesegmentamplitude|
    determines the height of the half ellipse.
  \item |\pgfsnakesegmentlength|
    determines the width of the half ellipse.
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=bumps] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}


\begin{snake}{coil}
  This snake adds a coil to the path. To understand how this works,
  imagine a three-dimensional spring. The spring's axis points along
  the line toward the target. Then, we ``view'' the spring from a
  certain angle. If we look ``straight from the side'' we will see a
  perfect sine curve, if we look ``more from the front'' we will see a
  coil. The following parameters influence the snake:  
  \begin{itemize}
  \item |\pgfsnakesegmentamplitude|
    determines how much the coil rises above the path and falls below
    it. Thus, this is the radius of the coil.
  \item |\pgfsnakesegmentlength|
    determines the distance between two consecutive ``curls.'' Thus,
    when the spring is see ``from the side'' this will be the wave
    length of the sine curve. 
  \item |\pgfsnakesegmentaspect|
    determines the ``viewing direction.'' A value of |0| means
    ``looking from the side'' and a value of |0.5|, which is the
    default, means ``look more from the front.'' 
  \end{itemize}
\begin{codeexample}[]
\begin{tikzpicture}[segment amplitude=10pt]
  \draw[snake=coil]                  (0,1) -- (3,1);
  \draw[snake=coil,segment aspect=0] (0,0) -- (3,0);
\end{tikzpicture}
\end{codeexample}
\end{snake}


\begin{snake}{expanding waves}
  This snake adds arcs to the path that get bigger along the line
  towards the target. The following parameters influence the snake:
  \begin{itemize}
  \item |\pgfsnakesegmentlength|
    determines the distance between consecutive arcs.
  \item |\pgfsnakesegmentangle|
    determines the opening angle below and above the path. Thus, the
    total opening angle is twice this angle.
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=expanding waves] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}


\begin{snake}{saw}
  This snake looks like the blade of a saw. The following parameters
  influence the snake:
  \begin{itemize}
  \item |\pgfsnakesegmentamplitude|
    determines how much each spike raises above the straight line.
  \item |\pgfsnakesegmentlength|
    determines the length each spike.
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=saw] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}


\begin{snake}{snake}
  This snake is the ``architypical'' snake: It looks like a snake seen
  from above. More precisely, the snake is a sine wave with a
  ``softened'' start and ending. The following parameters influence
  the snake: 
  \begin{itemize}
  \item |\pgfsnakesegmentamplitude|
    determines the sine wave's amplitude.
  \item |\pgfsnakesegmentlength|
    determines the sine wave's wave length.
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=snake] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}


\begin{snake}{ticks}
  This snake adds straight lines  the path that are orthogonal to the
  line toward the target. The following parameters influence the snake: 
  \begin{itemize}
  \item |\pgfsnakesegmentlength|
    determines the distance between consecutive ticks.
  \item |\pgfsnakesegmentamplitude|
    determines half the length of the ticks.
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=ticks] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}

\begin{snake}{triangles}
  This snake adds triangles to the path that point toward the
  target. The following parameters influence the snake: 
  \begin{itemize}
  \item |\pgfsnakesegmentlength|
    determines the distance between consecutive triangles.
  \item |\pgfsnakesegmentamplitude|
    determines half the length of the triangle side that is orthogonal
    to the path.
  \item |\pgfsnakesegmentobjectlength|
    determines the height of the triangle.
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=triangles] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}

\begin{snake}{crosses}
  This snake adds (diagonal) crosses to the path. The following
  parameters influence the snake:  
  \begin{itemize}
  \item |\pgfsnakesegmentlength|
    determines the distance between consecutive crosses.
  \item |\pgfsnakesegmentamplitude|
    determines half the hieght of each cross.
  \item |\pgfsnakesegmentobjectlength|
    determines width of each cross.
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=crosses] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}


\begin{snake}{waves}
  This snake adds arcs to the path that have a constant size. The
  following parameters influence the snake: 
  \begin{itemize}
  \item |\pgfsnakesegmentlength|
    determines the distance between consecutive arcs.
  \item |\pgfsnakesegmentangle|
    determines the opening angle below and above the path. Thus, the
    total opening angle is twice this angle.
  \item |\pgfsnakesegmentamplitude|
    determines the radius of each arc.
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=waves] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}


\begin{snake}{zigzag}
  This snake looks like a zig-zag line. The following parameters
  influence the snake:
  \begin{itemize}
  \item |\pgfsnakesegmentamplitude|
    determines how much the zig-zag lines raises above and falls below
    a straight line to the target point.
  \item |\pgfsnakesegmentlength|
    determines the length of a complete ``up-down'' cycle.
  \end{itemize}
\begin{codeexample}[]
\tikz{\draw[snake=zigzag] (0,0) -- (3,0);}
\end{codeexample}
\end{snake}



\begin{snake}{shape snake}
	This snake adds a succession of shapes to the path. The shape must
	have been defined by |\pgfdeclareshape| and must have defined a 
	background path. Please note that the shapes in a snake are not 
	nodes. They cannot have text inside them, be named, or referred to. 
	The snake simply adds the background path of the shape to the ongoing 
	snaked path.

\begin{codeexample}[]
\tikzset{paint/.style={snake=shape snake, draw=#1!50!black, fill=#1!50}}
\begin{tikzpicture}
  \draw [shape snake shape=dart,      paint=red]    (0,1.5) -- (3,1.5);
  \draw [shape snake shape=diamond,   paint=green]  (0,1)   -- (3,1);
  \draw [shape snake shape=rectangle, paint=blue]   (0,0.5) -- (3,0.5);
  \draw [shape snake shape=circle,    paint=yellow] (0,0)   -- (3,0);
\end{tikzpicture}
\end{codeexample}

	All shapes are positioned by their center anchor (as this is the only
	anchor that all shapes must define). A shape is drawn at the start 
	point of the path and, if the distance between the shapes is 
	appropriate, at the end point of the path.
	
\begin{codeexample}[]
\begin{tikzpicture}[snake=shape snake, shape snake shape=regular polygon]
  \draw [help lines] grid (3,2);
  \draw [thick] (0,0) -- (2,2) (1,0) -- (3,0);
  \draw [very thick, red!50, snake, shape snake sep=.5cm]  (1,0) -- (3,0);
  \draw [very thick, blue!50, snake, shape snake sep=.5cm] (0,0) -- (2,2);
\end{tikzpicture}
\end{codeexample}

	Keys for cusomizing specific shapes can be specified (e.g., 
	|star points|, |cloud puffs|, |kite angles|, and so on). However, you
	should be aware that the size of each shape is enforced using a 
	coodinate transformation, which may mean that settings involving 
	angles and distances may not appear entirely accurate. More general
	options such as |inner sep| and |minimum size| will be ignored, 
	but transformations can be applied to each segment as described
	below.
	
\begin{codeexample}[]
\tikzset{
  paint/.style={snake=shape snake, draw=#1!50!black, fill=#1!50},
  my star/.style={shape snake shape=star, star points=#1}
}
\begin{tikzpicture}[shape snake sep=.5cm, shape snake start size=.5cm]
  \draw [my star=9, paint=red]                            (0,1.5) -- (3,1.5);
  \draw [my star=5, paint=blue]                           (0,.75) -- (3,.75);
  \draw [my star=5, paint=yellow, shape border rotate=30] (0,0) -- (3,0);
\end{tikzpicture}
\end{codeexample}

	There are various keys to control the drawing of the shape snake (to
	use \pgfname{} keys in \tikzname{}, simply remove the 
	\declare{|/pgf/|} path).

\begin{key}{/pgf/shape snake shape=\meta{shape} (initially circle)}

	Set the shape for the snake. If \meta{shape} is defined in a shape
	library which has not been loaded then an error will result.
	
\end{key}

\begin{key}{/pgf/shape snake sep=\meta{spacing} (initially {.25cm, between centers})}

	Set the spacing between the shapes on the snaked path. This can be
	just a distance on its own, but the additional keywords 
	|between centers|, and |between borders| (which must be preceded by a 
	comma), specify that the distance	is between the center anchors of 
	the shapes or between the edges of the \emph{boundaries} of
	the shape borders.
	
\begin{codeexample}[]
\begin{tikzpicture}[snake=shape snake, shape snake start size=.5cm,
    paint/.style={snake, draw=#1!50!black, fill=#1!50},
    shape snake shape=signal, signal from=west, signal to=east]
  \draw [help lines] grid (3,2);
  \draw [paint=red, shape snake sep=.5cm]                    (0,0) -- (3,0);
  \draw [paint=green, shape snake sep={1cm, between center}] (0,1) -- (3,1);
  \draw [paint=blue, shape snake sep={1cm, between borders}] (0,2) -- (3,2);
\end{tikzpicture}
\end{codeexample}

\end{key}


  
\begin{key}{/pgf/shape snake evenly spread=\meta{number}}

  This key overides the |shape snake sep| key and forces the snake to
  fit \meta{number} shapes evenly across the path. 
  If \meta{number} is less than |1|, then no shapes will be drawn. 
  If \meta{number} equals |1|, then one shape is drawn in the middle 
  of the path. 
  The additional keywords |by centers| (the default, if no keyword is
  specified) and |by borders| can be used (both preceded by a comma), 
  to specify how the distance between shapes is determined. These
  keywords will only have a noticable effect if the snake is scaled.
  
\begin{codeexample}[]
\tikzset{my snake/.style={%
  snake=shape snake, shape snake shape=rectangle, shape snake start size=.5cm,
  draw=#1!50!black, fill=#1!50}
}
\begin{tikzpicture}
  \fill [shape snake evenly spread={5, by borders}, 
         my snake=green, shape snake scaled]           (0,2)   -- (3,2);
  \fill [shape snake evenly spread={5, by centers},
         my snake=blue, shape snake scaled]            (0,1.5) -- (3,1.5);   
  \fill [my snake=red, shape snake evenly spread=5]    (0,1)   -- (3,1);
  \fill [my snake=orange, shape snake evenly spread=4] (0,.5)  -- (3,.5);
  \fill [my snake=gray, shape snake evenly spread=1]   (0,0)   -- (3,0);
\end{tikzpicture}
\end{codeexample}

\end{key}

\begin{key}{/pgf/shape snake sloped=\meta{boolean} (default true)}

	By default, shapes are rotated to the slope of the snaked path. If 
	\meta{boolean} is the value |false|, then this rotation is turned 
	off. Internally this sets the \TeX-if |\ifpgfshapesnakesloped|
	appropriately.

\begin{codeexample}[]
\tikzset{
  shape snake start width=.65cm, shape snake start height=.45cm,
  shape snake shape=isosceles triangle, shape snake sep=.75cm,
  paint/.style={snake, draw=#1!50!black, fill=#1!50}
}
\begin{tikzpicture}[snake=shape snake]
  \draw [help lines] grid (3,2);
  \draw [paint=red] (0,0) -- (2,2);
  \draw [paint=blue, shape snake sloped=false] (1,0) -- (3,2);
\end{tikzpicture}
\end{codeexample}

\end{key}%

	It is possible to scale the width and height of the shapes across the
	length of the snaked path. The shapes are scaled between the starting
	size and the ending size. The following keys customize the way the
	snake shapes are scaled:
	
\begin{key}{/pgf/shape snake scaled=\meta{boolean} (default true)}
	Internally this sets the \TeX-if |\ifpgfshapesnakescaled| 
	appropriately.
	
\begin{codeexample}[]
\tikzset{
  bigger/.style={shape snake start size=.125cm, shape snake end size=.5cm},
  smaller/.style={shape snake start size=.5cm, shape snake end size=.125cm},
  shape snake sep={.25cm, between borders}
}
\begin{tikzpicture}[snake=shape snake]
  \draw [help lines] grid (3,2);
  \fill [snake, shape snake scaled, bigger, red!50]   (0,1) -- (3,2);
  \fill [snake, shape snake scaled, smaller, blue!50] (0,0) -- (3,1);
\end{tikzpicture}
\end{codeexample}

\end{key}

\begin{key}{/pgf/shape snake start width=\meta{length} (initially .25cm)}
	The starting width of the shape.
\end{key}%

\begin{key}{/pgf/shape snake start height=\meta{length} (initially .25cm)}
	The starting height of the shape.
\end{key}%

\begin{stylekey}{/pgf/shape snake start size=\meta{length}}
	Set both the the start height and start width simultaneously.
\end{stylekey}%

\begin{key}{/pgf/shape snake end width=\meta{length} (initially .125cm)}
	The recommended ending width of the shape. Note, that this is the
	width that a shape will take only if it is drawn exactly at the end
	of the path.
	
	
\begin{codeexample}[]
\tikzset{
  bigger/.style={shape snake start size=.25cm, shape snake end size=1cm},
  smaller/.style={shape snake start size=1cm, shape snake end size=.25cm},
  shape snake scaled, snake=shape snake
}
\begin{tikzpicture}
  \draw [help lines]grid(3,2);
  \fill [snake, bigger,  shape snake sep={.25cm, between borders}, blue!50] 
    (0,1.5) -- (3,1.5);
  \fill [snake, smaller, shape snake sep={1cm, between centers},   red!50]  
    (0,.5)  -- (3,.5);
  \draw [gray, dotted] (0,1.625) -- (3,2)    (0,1.375) -- (3,1) 
                       (0,1)     -- (3,.625) (0,0)     -- (3,.375); 
\end{tikzpicture}
\end{codeexample}

\end{key}%

\begin{key}{/pgf/shape snake end height=\meta{length}}
	The recommended ending height of the shape.
\end{key}%

\begin{stylekey}{/pgf/shape snake end size=\meta{length}}
	Set both the the end height and end width simultaneously.
\end{stylekey}

There is an additional TikZ key for the shape snake:

\begin{stylekey}{/tikz/shape snake tranform=\meta{keys}}
	This key parses \meta{keys}, which should be things like |rotate|, or
	|yshift|, and so on. The resulting transformation is applied to each 
	segment as it is drawn. It is analogous to the pgf command
	|\pgfsetsnakesegmenttransformation| (and in fact, uses it internally).

\begin{codeexample}[]
\tikzset{my snake/.style={%
  snake=shape snake, shape snake shape=rectangle, shape snake sep=.5cm,
  very thick, draw=#1!50}
}
\begin{tikzpicture}
  \draw [help lines] grid (3,2);
  \draw [thick] (0,0.5) -- (3,1.5);
  \draw [my snake=red,  shape snake transform={yshift=7.5pt}] 
     (0,0.5) -- (3,1.5);
  \draw [my snake=blue, shape snake transform={yshift=-7.5pt, rotate=45}] 
     (0,0.5) -- (3,1.5);
\end{tikzpicture}
\end{codeexample}

\end{stylekey}

\end{snake}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "pgfmanual-pdftex-version"
%%% End: 
