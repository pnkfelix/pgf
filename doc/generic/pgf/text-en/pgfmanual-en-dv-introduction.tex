% Copyright 2006 by Till Tantau
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Free Documentation License.
%
% See the file doc/generic/pgf/licenses/LICENSE for more details.


\section{Introduction to Data Visualization}


This chapter has not yet been written. The following are for test
purposes only and may and will change without notice.


% The following is just testing.

\pgfooclass{person}
{
  % Constructor
  \method person(#1) {
    \pgfooset{name}{#1}
  }

  \method greet() {
    "I am \pgfoovalueof{name}. Hello!"
  }

  \method say goodbye() {
    "Goodbye!"
  }
}

\pgfoonewsignal{someone should be greeted}
\pgfoonewsignal{let us say goodbye}

\pgfoonew \alice=new person(Alice)
\pgfoonew \bob=new person(Bob)

\alice.connect signal and slot(someone should be greeted,greet)
\alice.connect signal and slot(let us say goodbye,say goodbye)
\bob.connect signal and slot(someone should be greeted,greet)
\bob.connect signal and slot(let us say goodbye,say goodbye)

Charlie enters the room. He hears something: \pgfooemit{someone
should be greeted}. Then he leaves, upon which he hears
\pgfooemit{let us say goodbye}.


\def\daxline#1 #2 #3 #4 {
  \pgfkeyssetvalue{/data point/dax/low}{#1}
  \pgfkeyssetvalue{/data point/dax/high}{#2}
  \pgfkeyssetvalue{/data point/dax/entry}{#3}
  \pgfkeyssetvalue{/data point/dax/exit}{#4}
  \pgfdatapoint
}

\begin{tikzpicture}
  \pgfnewdatavisualization

  \pgfoonew \obj=new count up(day)
  \obj.default connects()
  
  \pgfoonew \obj=new line transformer(day,\pgfqpoint{3mm}{0mm})
  \obj.default connects()
  \pgfoonew \obj=new line transformer(y,\pgfqpoint{1cm}{1cm})
  \obj.default connects()

  \pgfoonew \obj=new attribute locator(dax,0,100,y,0,1,)
  \obj.default connects()
  \pgfoonew \obj=new candle stick visualizer(dax)
  \obj.default connects()

  \pgfoonew \dayinterval=new interval(,)
  \dayinterval.default connects()
  \dayinterval.set min adjust relative(-.1)
  \dayinterval.set max adjust relative(.1)
  \pgfoonew \daybounder=new attribute bounder(day,\dayinterval)
  \daybounder.default connects()

  \pgfoonew \daxinterval=new interval(,)
  \daxinterval.default connects()
  \daxinterval.set min adjust relative(-.1)
  \daxinterval.set max adjust relative(.1)
  \pgfoonew \daxbounder=new attribute bounder(dax,\daxinterval)
  \daxbounder.default connects()
  
  \pgfoonew \dayaxis=new straight axis(day,\dayinterval)
  \dayaxis.default connects()
  \pgfoonew \daxaxis=new straight axis(dax,\daxinterval)
  \daxaxis.default connects()

  \begin{pgfdataset}
    \daxline 2000 2300 2100 2200 
    \daxline 2000 2350 2200 2250 
    \daxline 2200 2300 2250 2260 
    \daxline 1800 2260 2260 1900 
    \daxline 2000 2300 2100 2200 
    \daxline 2000 2350 2200 2250
    \daxline 2200 2300 2250 2260 
    \daxline 1800 2260 2260 1900 
  \end{pgfdataset}

\end{tikzpicture}


\def\dataline#1 #2 #3 #4 #5 #6 #7 #8 {%
  \pgfkeyssetvalue{/data point/a}{#1}
  \pgfkeyssetvalue{/data point/b}{#2}
  \pgfkeyssetvalue{/data point/c}{#3}
  \pgfkeyssetvalue{/data point/d}{#4}
  \pgfkeyssetvalue{/data point/e}{#5}
  \pgfkeyssetvalue{/data point/f}{#6}
  \pgfkeyssetvalue{/data point/g}{#7}
  \pgfkeyssetvalue{/data point/h}{#8}
  \pgfdatapoint
}

\begin{tikzpicture}
  \pgfnewdatavisualization

  %\pgfoonew new attribute locator(a,0,1,x,0,1,)
  %\pgfoonew new attribute locator(b,0,1,y,0,1,)
  \pgfoonew \obj=new count up(y)
  \obj.default connects()
  
  \pgfoonew \obj=new sum(a)
  \obj.default connects()
  
  \pgfkeyssetvalue{/data point/x}{\pgfkeysvalueof{/data point/a/sum}}
  
  \pgfoonew \transformer=new line transformer(x,\pgfpointxy{.1}{.05})
  \transformer.default connects()
  
  \pgfoonew \transformer=new line transformer(y,\pgfpointxy{0}{1})
  \transformer.default connects()

  \pgfoonew \visualizer=new plot handler visualizer(\pgfplothandlerlineto)
  \visualizer.default connects()
  \visualizer.set use path(\color{red}\pgfusepath{stroke})
  \pgfoonew \visualizer=new plot mark visualizer(*)
  \visualizer.default connects()
  
  \pgfoonew \interval=new interval(0,)
  \interval.default connects()
  \interval.set min adjust relative(-.1)
  \interval.set max adjust relative(.1)
  \pgfoonew \abounder=new attribute bounder(x,\interval)
  \abounder.default connects()
  
  \pgfoonew \yinterval=new interval(,)
  \yinterval.set min adjust relative(-.1)
  \yinterval.set max adjust relative(.1)
  \yinterval.default connects()
  
  \pgfoonew \bbounder=new attribute bounder(y,\yinterval)
  \bbounder.default connects()
  
  \pgfoonew \pinterval=new interval(,)
  \pinterval.default connects()
  \pgfoonew \pbounder=new attribute bounder(angle,\pinterval)
  \pbounder.default connects()

  \pgfoonew \rinterval=new interval(,)
  \rinterval.default connects()
  \pgfoonew \rbounder=new attribute bounder(b,\rinterval)
  \rbounder.default connects()
  
  \pgfoonew \axis=new straight axis(x,\interval)
  \axis.default connects()
  \pgfoonew \bxis=new straight axis(y,\yinterval)
  \bxis.default connects()

  \begin{pgfdataset}
    \dataline 10.0	8.04	10.0	9.14	10.0	7.46	8.0	6.58 
    \dataline 8.0	6.95	8.0	8.14	8.0	6.77	8.0	5.76 
    \dataline 13.0	7.58	13.0	8.74	13.0	12.74	8.0	7.71 
    \dataline 9.0	8.81	9.0	8.77	9.0	7.11	8.0	8.84 
    \dataline 11.0	8.33	11.0	9.26	11.0	7.81	8.0	8.47 
    \dataline 14.0	9.96	14.0	8.10	14.0	8.84	8.0	7.04 
    {\dataline 6.0	7.24	6.0	6.13	6.0	6.08	8.0	5.25 }
    \dataline 4.0	4.26	4.0	3.10	4.0	5.39	19.0	12.50 
    \dataline 12.0	10.84	12.0	9.13	12.0	8.15	8.0	5.56 
    {\pgfkeyssetvalue{/data point/name}{yesterday} \dataline 7.0	4.82	7.0	7.26	7.0	6.42	8.0	7.91 }
    {\pgfkeyssetvalue{/data point/name}{today} \dataline 5.0	5.68	5.0	4.74	5.0	5.73	8.0    6.89 }
  \end{pgfdataset}

  \draw (yesterday) -- (today);
  \pgfkeyssetvalue{/data point/tick lower length}{4pt}
  \pgfkeyssetvalue{/data point/tick higher length}{4pt}

  \begin{scope}[->,thick]
     {
       \bbounder.goto min()
       \pgfkeyssetvalue{/data point/y}{0}
       \axis.visualize()
       % Grid lines
       \begin{scope}[-,thin,black!50]
         \bbounder.goto min()
         \pgfkeysgetvalue{/data point/y}{\mymin}
         \bbounder.goto max()
         \pgfkeysgetvalue{/data point/y}{\mymax}
         \foreach \yval in {\mymin,...,\mymax}
         {
           \pgfkeyssetvalue{/data point/y}{\yval}
           \axis.visualize()
           \begin{scope}[thick,black]
             \axis.visualize as tick()
           \end{scope}
         }
       \end{scope}
     }
    {
      \abounder.goto min()
      \bxis.visualize()
      % Grid lines
      \begin{scope}[-,thin,black!50]
        \abounder.goto min()
        \pgfkeysgetvalue{/data point/x}{\mymin}
        \abounder.goto max()
        \pgfkeysgetvalue{/data point/x}{\mymax}
        \foreach \xval in {0,10,...,\mymax}
        {
          \pgfkeyssetvalue{/data point/x}{\xval}
          \bxis.visualize()
            \begin{scope}[thick,black]
              \bxis.visualize as tick()
            \end{scope}

            \pgfkeyssetvalue{/data point/tick lower length}{0pt}
            \pgfkeyssetvalue{/data point/tick higher length}{3pt}
          \pgfmathparse{\xval+9}
          \let\temp=\pgfmathresult
          \foreach \xvala in {\xval,...,\temp}
          {
            \pgfkeyssetvalue{/data point/x}{\xvala}
            \bxis.visualize as tick()
          }
        }
      \end{scope}
    }
  \end{scope}
  

\end{tikzpicture}



%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "pgfmanual"
%%% End: 
